"use strict";function l(e){return function(e){if(Array.isArray(e))return e}(e)||n(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function u(e){return function(e){if(Array.isArray(e)){for(var n=0,t=new Array(e.length);n<e.length;n++)t[n]=e[n];return t}}(e)||n(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function n(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function a(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var t=function(){function t(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,r;return e=t,r=[{key:"create",value:function(n){return fetch("https://applicants-db19e.firebaseio.com/findings.json",{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){return n.id=e.name,n}).then(o).then(t.addLineFromLocalStorage).catch(function(e){return console.log(e)})}},{key:"addLineFromLocalStorage",value:function(){var e=c(),n=e[e.length-1];i(),s(n)}},{key:"receprion",value:function(){return fetch("https://applicants-db19e.firebaseio.com/findings.json",{method:"GET"}).then(function(e){return e.json()}).then(function(e){console.log(e),t.renderLineWhenRestart(e)})}},{key:"renderLineWhenRestart",value:function(e){for(var n in e)i(n),s(e[n])}}],(n=null)&&a(e.prototype,n),r&&a(e,r),t}();function s(e){var n=document.querySelector(".hero__count"),t=document.querySelectorAll(".hero__line").length,r=u(document.querySelectorAll(".add-field")),a=u(document.querySelectorAll(".form__star")),s=r.slice(-6),i=a.slice(-5);n.innerHTML=t,s.forEach(function(n){var t=n.getAttribute("data-name");e.forEach(function(e){"file"===t?n.setAttribute("src",e.file):t===e.name&&(n.innerHTML=e.value)})});var o=u(document.querySelectorAll(".form__count")),c=l(o[o.length-1].innerHTML).slice(0);i.forEach(function(e,n){n<c&&e.classList.add("select")})}function i(e){var n=document.querySelector(".hero__inner"),t=document.createElement("div");t.className="hero__line line",t.setAttribute("id",e),t.innerHTML='\n    <div class="line__applicant">\n        <img class="line__photo add-field" data-name="file" src="1" alt="photo">\n        <div class="line__block-name">\n            <div class="line__name add-field" data-name="name"></div>\n            <span class="line__vacancy"> Вакансия:\n                <span class="line__vacancy-name add-field" data-name="vacancy"></span>\n            </span>\n        </div>\n    </div>\n    <div class="line__phone-block">\n        <div class="line__image">\n            <svg class="line__svg">\n                <use xlink:href="svg/sprite.svg#phone" />\n            </svg>\n        </div>\n        <div class="line__phone add-field" data-name="phone"></div>\n    </div>\n    <div class="line__email-block">\n        <div class="line__image">\n            <svg class="line__svg">\n                <use xlink:href="svg/sprite.svg#email" />\n            </svg>\n        </div>\n        <div class="line__email add-field" data-name="email"></div>\n    </div>\n    <div class="form__block-rating">\n        <span class="form__rating-text">Средняя оценка: <span class="form__count add-field" data-name="count"></span></span>\n        <div class="form__svg-block">\n            <svg class="form__star">\n                <use xlink:href="svg/sprite.svg#star"></use>\n            </svg>\n            <svg class="form__star">\n                <use xlink:href="svg/sprite.svg#star"></use>\n            </svg>\n            <svg class="form__star">\n            \n                <use xlink:href="svg/sprite.svg#star"></use>\n            </svg>\n            <svg class="form__star">\n                <use xlink:href="svg/sprite.svg#star"></use>\n            </svg>\n            <svg class="form__star">\n                <use xlink:href="svg/sprite.svg#star"></use>\n            </svg>\n        </div>\n    </div>\n    ',n.append(t)}function o(e){var n=c();n.push(e),localStorage.setItem("findings",JSON.stringify(n));try{for(var t="LocalStorageIsNOTFull";;)t+=t,localStorage.setItem("stringData",t)}catch(e){console.log("Local Storage is full, Please empty data")}}function c(){return JSON.parse(localStorage.getItem("findings")||"[]")}var e=document.querySelector(".hero__btn-add"),r=document.querySelector("#cancel"),d=document.getElementById("form"),f=document.querySelector(".overlay"),v=d.querySelectorAll(".input-block__input"),m=document.querySelector('input[type="file"]'),p=document.querySelector(".form__file-name"),h=d.querySelector("#submit"),_=d.querySelector(".form__select");e.addEventListener("click",function(){f.classList.remove("hidden"),f.classList.add("visible")}),r.addEventListener("click",function(){f.classList.remove("visible"),f.classList.add("hidden"),m.value="",p.innerHTML="",v.forEach(function(e){e.value=""}),_.options[0].selected=!0}),h.addEventListener("click",function(){v.forEach(function(e){var n=e.closest(".input-block").querySelector(".input-block__valid");n.classList.remove("visible"),n.classList.remove("hidden"),""===e.value?(f.classList.remove("hidden"),f.classList.add("visible"),n.classList.add("visible")):(n.classList.remove("visible"),n.classList.add("hidden"))})});function g(e){var n=e.closest(".input-block").querySelector(".input-block__valid");n.classList.remove("visible"),n.classList.remove("hidden")}v.forEach(function(e){e.addEventListener("focus",function(){return g(e)})}),m.addEventListener("change",function(){return g(m)}),d.addEventListener("submit",function(e){e.preventDefault();var n=Math.round((parseInt(E.innerHTML)+parseInt(S.innerHTML)+parseInt(k.innerHTML))/3);var a=[];a.push({name:"count",value:n}),function(e,n){var t=new FileReader;t.onload=n,t.readAsDataURL(e)}(m.files[0],function(r){v.forEach(function(e){var n=new FormData;"file"===e.getAttribute("type")?(n.append("file",r.target.result),n.append("name",e.name)):(n.append("name",e.name),n.append("value",e.value));var t={};n.forEach(function(e,n){t[n]=e}),a.push(t),h.disabled=!0,e.value=""}),_.options[0].selected=!0,m.value="",p.innerHTML="",f.classList.add("hidden"),t.create(a).then(function(){h.disabled=!1})})}),window.onload=function(){t.receprion()},m.addEventListener("change",function(){var e=m.value;e=e.replace(/\\/g,"/").split("/").pop(),p.innerHTML="Имя файла: "+e});var y=u(document.querySelectorAll(".form__resume-star")),L=u(document.querySelectorAll(".form__test-star")),b=u(document.querySelectorAll(".form__interview-star")),E=document.querySelector(".form__resume-count"),S=document.querySelector(".form__test-count"),k=document.querySelector(".form__interview-count");function q(t,r){var a;t[0].classList.add("select"),t.forEach(function(e,n){e.addEventListener("mouseover",function(){(a=t.slice(0,n+1)).forEach(function(e){e.classList.add("active")})}),e.addEventListener("mouseleave",function(){t.forEach(function(e){e.classList.remove("active")}),t[0].classList.add("select")}),e.addEventListener("click",function(){r.innerHTML=n+1,t.forEach(function(e){e.classList.remove("select")}),a.forEach(function(e){e.classList.add("select")})})})}q(y,E),q(L,S),q(b,k),function(){if("function"==typeof NodeList.prototype.forEach)return;NodeList.prototype.forEach=Array.prototype.forEach}(),Element.prototype.closest||(Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest=function(e){var n=this;if(!document.documentElement.contains(this))return null;do{if(n.matches(e))return n;n=n.parentElement}while(null!==n);return null});